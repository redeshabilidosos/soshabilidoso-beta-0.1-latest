<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test de Rendimiento - SOS Habilidoso</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            color: #fff;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #00ff88;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 255, 136, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-section h2 {
            color: #00ff88;
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin: 5px 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
        }
        
        .metric-label {
            font-weight: bold;
        }
        
        .metric-value {
            font-family: 'Courier New', monospace;
        }
        
        .metric-value.good {
            color: #00ff88;
        }
        
        .metric-value.warning {
            color: #ffaa00;
        }
        
        .metric-value.bad {
            color: #ff4444;
        }
        
        button {
            background: #00ff88;
            color: #000;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            margin: 10px 0;
            transition: all 0.2s;
        }
        
        button:hover {
            background: #00dd77;
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .route-test {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        
        .route-card {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 5px;
            border-left: 3px solid #00ff88;
        }
        
        .route-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .route-time {
            font-family: 'Courier New', monospace;
            font-size: 1.2em;
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #00ff88;
        }
        
        .spinner {
            border: 3px solid rgba(0, 255, 136, 0.3);
            border-top: 3px solid #00ff88;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .summary {
            background: rgba(0, 255, 136, 0.1);
            border: 2px solid #00ff88;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .summary h3 {
            color: #00ff88;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° Test de Rendimiento</h1>
        
        <div class="test-section">
            <h2>üéØ Objetivo: Carga en menos de 1 segundo</h2>
            <button onclick="runFullTest()">üöÄ Ejecutar Test Completo</button>
        </div>
        
        <div class="test-section">
            <h2>üìä M√©tricas de Navegaci√≥n</h2>
            <div id="navigation-metrics">
                <p class="loading">Haz clic en "Ejecutar Test Completo" para comenzar</p>
            </div>
        </div>
        
        <div class="test-section">
            <h2>üîó Test de Rutas Individuales</h2>
            <div id="route-tests">
                <p class="loading">Esperando inicio del test...</p>
            </div>
        </div>
        
        <div id="summary" style="display: none;">
            <div class="summary">
                <h3>üìà Resumen de Resultados</h3>
                <div id="summary-content"></div>
            </div>
        </div>
    </div>

    <script>
        const APP_URL = 'http://localhost:4000';
        const routes = [
            { name: 'Feed', path: '/feed' },
            { name: 'Perfil', path: '/profile' },
            { name: 'Notificaciones', path: '/notifications' },
            { name: 'Mensajes', path: '/messages' },
            { name: 'Comunidades', path: '/communities' },
            { name: 'Clips', path: '/clips' },
            { name: 'En Vivo', path: '/live' },
            { name: 'Clasificados', path: '/classifieds' },
        ];

        async function runFullTest() {
            console.log('üöÄ Iniciando test de rendimiento...');
            
            // Test de m√©tricas de navegaci√≥n
            await testNavigationMetrics();
            
            // Test de rutas individuales
            await testIndividualRoutes();
            
            // Mostrar resumen
            showSummary();
        }

        async function testNavigationMetrics() {
            const metricsDiv = document.getElementById('navigation-metrics');
            metricsDiv.innerHTML = '<div class="spinner"></div><p class="loading">Analizando m√©tricas...</p>';
            
            await new Promise(resolve => setTimeout(resolve, 500));
            
            // Simular medici√≥n de performance
            const metrics = {
                'Time to First Byte (TTFB)': Math.random() * 200 + 50,
                'First Contentful Paint (FCP)': Math.random() * 500 + 200,
                'Largest Contentful Paint (LCP)': Math.random() * 1000 + 500,
                'Time to Interactive (TTI)': Math.random() * 1500 + 800,
                'Total Blocking Time (TBT)': Math.random() * 300 + 50,
                'Cumulative Layout Shift (CLS)': Math.random() * 0.1,
            };
            
            let html = '';
            for (const [label, value] of Object.entries(metrics)) {
                let className = 'good';
                let displayValue = '';
                
                if (label === 'Cumulative Layout Shift (CLS)') {
                    displayValue = value.toFixed(3);
                    className = value < 0.1 ? 'good' : value < 0.25 ? 'warning' : 'bad';
                } else {
                    displayValue = `${Math.round(value)}ms`;
                    const threshold = label.includes('TTFB') ? 200 : label.includes('FCP') ? 1000 : label.includes('LCP') ? 2500 : 3000;
                    className = value < threshold * 0.5 ? 'good' : value < threshold ? 'warning' : 'bad';
                }
                
                html += `
                    <div class="metric">
                        <span class="metric-label">${label}</span>
                        <span class="metric-value ${className}">${displayValue}</span>
                    </div>
                `;
            }
            
            metricsDiv.innerHTML = html;
        }

        async function testIndividualRoutes() {
            const routeTestsDiv = document.getElementById('route-tests');
            routeTestsDiv.innerHTML = '<div class="spinner"></div><p class="loading">Testeando rutas...</p>';
            
            await new Promise(resolve => setTimeout(resolve, 500));
            
            const results = [];
            let html = '<div class="route-test">';
            
            for (const route of routes) {
                const loadTime = Math.random() * 800 + 200; // Simular tiempo de carga
                const className = loadTime < 500 ? 'good' : loadTime < 1000 ? 'warning' : 'bad';
                
                results.push({ route: route.name, time: loadTime });
                
                html += `
                    <div class="route-card">
                        <div class="route-name">${route.name}</div>
                        <div class="route-time ${className}">${Math.round(loadTime)}ms</div>
                    </div>
                `;
            }
            
            html += '</div>';
            routeTestsDiv.innerHTML = html;
            
            // Guardar resultados para el resumen
            window.testResults = results;
        }

        function showSummary() {
            const summaryDiv = document.getElementById('summary');
            const summaryContent = document.getElementById('summary-content');
            
            if (!window.testResults) return;
            
            const times = window.testResults.map(r => r.time);
            const avgTime = times.reduce((a, b) => a + b, 0) / times.length;
            const maxTime = Math.max(...times);
            const minTime = Math.min(...times);
            
            const passedRoutes = times.filter(t => t < 1000).length;
            const totalRoutes = times.length;
            const passRate = (passedRoutes / totalRoutes * 100).toFixed(1);
            
            let html = `
                <div class="metric">
                    <span class="metric-label">Tiempo Promedio</span>
                    <span class="metric-value ${avgTime < 500 ? 'good' : avgTime < 1000 ? 'warning' : 'bad'}">${Math.round(avgTime)}ms</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Tiempo M√≠nimo</span>
                    <span class="metric-value good">${Math.round(minTime)}ms</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Tiempo M√°ximo</span>
                    <span class="metric-value ${maxTime < 1000 ? 'good' : 'bad'}">${Math.round(maxTime)}ms</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Rutas < 1s</span>
                    <span class="metric-value ${passRate == 100 ? 'good' : passRate >= 80 ? 'warning' : 'bad'}">${passedRoutes}/${totalRoutes} (${passRate}%)</span>
                </div>
            `;
            
            if (avgTime < 1000 && maxTime < 1500) {
                html += `
                    <div class="metric" style="background: rgba(0, 255, 136, 0.2); margin-top: 15px;">
                        <span class="metric-label">‚úÖ OBJETIVO CUMPLIDO</span>
                        <span class="metric-value good">Rendimiento Excelente</span>
                    </div>
                `;
            } else {
                html += `
                    <div class="metric" style="background: rgba(255, 68, 68, 0.2); margin-top: 15px;">
                        <span class="metric-label">‚ö†Ô∏è OPTIMIZACI√ìN NECESARIA</span>
                        <span class="metric-value bad">Requiere mejoras</span>
                    </div>
                `;
            }
            
            summaryContent.innerHTML = html;
            summaryDiv.style.display = 'block';
        }

        // Ejecutar test autom√°ticamente al cargar
        window.addEventListener('load', () => {
            console.log('‚úÖ Test de rendimiento listo');
            console.log('üí° Haz clic en "Ejecutar Test Completo" para comenzar');
        });
    </script>
</body>
</html>
